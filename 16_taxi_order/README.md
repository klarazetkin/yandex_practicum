# Прогнозирование количества заказов такси

### Постановка задачи
Заказчик исследования - агрегатор такси "Четенькое такси". Задача - предсказать количество заказов на следующий час для решения бизнес-задач. 

### Импорт и первичное исследование данных
Исходные данные - датасет на 26_496 строк и одну колонку. Колонку с датами импортировали как индекс. Вторая колонка - количество заказов в формате int64. Пропусков нет.

Датасет включает в себя данные за полгода - с 1 марта по 31 августа 2018, то есть сезонные колебания (зима, весна, лето, осень) в датасете не отражены.

Данные имеют шаг 10 минут.

Была проведена декомпозиция данных на тренд, сезонность и остатки. Тренд на протяжении месяцев растущий, что делает временной ряд не стационарным (среднее растет). Сезонность проявляется в течение суток. Остатки довольно значительные, что негативно влияет на качество предсказаний моделей. 

### Предобработка данных
Лишних столбцов нет, дубликатов не может быть, т.к. индекс - уникальная дата+время. Единственный столбец поименован нормально, тип данных соответствует физическому смыслу столбца (менять типы данных не надо), пропусков нет.

В задании указано, что предсказывать нужно нагрузку на следующий час. Данные были ресемплированы, интервал заменен на один час.

Существенных выбросов в датасете нет. На позднейшей по времени части датасета, которая попадет в тестовую часть, есть выбросы - значения num_orders > 300. В трех случаях эти выбросы приходятся на 02:00 понедельника, в одном случае - на четверг. Значения заменены для понедельников - на медиану по предыдущим понедельникам за месяц, для четверга - на медиану четвергов.

Были созданы дополнительные обучающие признаки, описывающие количество заказов в предыдущие 2 часа. Для первых двух часов часть новых признаков пустая, поэтому эти строки были удалены. В обучающие признаки добавлены также день недели, день месяца и час дня.

### Подготовка датасетов
Исходный датасет был разделен на тренировочный и тестовый в соотношении 4:1. 

### Обучение моделей
На датасете обучены модели:
* LinearRegressor
* RandomForestRegressor
* CatBoostRegressor
* LGBMRegressor

Модели сначала обучены с дефолтными параметрами, затем гиперпараметры подобраны на GridSearchCV.

### Вывод
Лучше всего показала себя модель случайного леса, обученная с дефолтными параметрами. 
Метрика на тесте rmse_test = 38.3, что меньше стандартного отклонения датасета std = 44.40. 

Модель в основном занижает значения, на трейне меньше, чем на тесте.  Кроме того, судя по графикам, модели улавливают закономерности, но с определенным запозданием, и сглаживают экстремальные значения.

Модель рекомендуется к дообучению.