# Предсказание температуры звезды

## Постановка задачи
Задача данного исследования - разработать нейронную сеть, которая поможет предсказывать абсолютную температуру на поверхности звезды. Заказчик исследования - лаборатория "Небо на ладони".

## Исходные данные
Исходные данные представляют собой датасет, в котором содержится информация о 240 уже изученных звездах, количество колонок - 7. Пустых значений, выбросов, дубликатов нет. Есть один неинформативный признак - id звезды.

Есть выраженные корреляции целевого признака с обучающими:

средней силы положительная корреляция с относительной светимостью (Luminosity) - К = 0.39;
средней силы отрицательная корреляция с абсолютной звездной величиной (Absolute magnitude) - К = -0.41
Предобработка данных
В ходе предобработки были переименованы колонки, изменен тип данных в колонке 'Star type' на object, что соответствует природе данных. Удален неинформативный столбец 'Unnamed' c id звезды. Удалены скрытые дубликаты в колонке 'Star color'.

## Структура получившегося датасета:

* целевой признак - 'temperature' - температура на поверхности звезды в градусах Kельвина.
* пять обучающих признаков: три численные ('luminosity', 'radius', 'absolute_magnitude') и 
* два категориальные ('star_type', 'star_color').
Подготовка датасетов для обучения моделей
В ходе предобработки было произведено кодирования категориальных признаков методом OHE, масштабирование численных признаков с использованием StandardScaler(). В получившемся датасете 240 строк и 13 колонок.

Датасет разделен на тренировочный и тестовый, получившиеся датасеты конвертированы в тензоры.

## Выбор базовой конфигурации модели
Исходя из получившегося датасета и задачи исследования, в качестве отправной точки была выбрана конфигурация модели нейронной сети - прямая полносвязная сеть с 13 входными нейронами, одним скрытым слоем из четырех нейронов, и выходным слоем, в котором один нейрон.

В ходе экспериментов были испробованы различные комбинации нейронов в слоях, функции активации скрытых слоев, функция активации выходного слоя.

## Лучшая модель

Лучше всего показала себя модель с пятью скрытыми слоями. Ее конфигурация:

1
net_thin
Sequential(
  (0): Linear(in_features=13, out_features=11, bias=True)
  (1): ReLU()
  (2): Linear(in_features=11, out_features=9, bias=True)
  (3): ReLU()
  (4): Linear(in_features=9, out_features=7, bias=True)
  (5): ReLU()
  (6): Linear(in_features=7, out_features=5, bias=True)
  (7): ReLU()
  (8): Linear(in_features=5, out_features=3, bias=True)
  (9): ReLU()
  (10): Linear(in_features=3, out_features=1, bias=True)
  (11): ReLU()
)
RMSE ниже стандартного отклонения целевого признака:

RMSE on train: 3355.4382
RMSE on test: 5890.4087
Окончательный выбор базовой модели
Для развития выбрана модель с большим количеством нейронов в слоях:

n_neurons = [13, 32, 16, 15, 4, 2, 1]
batch_size = 10
dropout = 0.1
Ее метрики:

RMSE на трейне: tensor(3265.3425, grad_fn=)
RMSE на тесте: tensor(6301.6914, grad_fn=)
