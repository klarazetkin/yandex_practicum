# Поиск изображений, соответствующих текстовому описанию
## Постановка задачи

Заказчик проекта - фотохостинг для профессиональных фотографов «Со Смыслом» (“With Sense”).

Пользователи сервиса размещают свои фотографии на хостинге и сопровождают их полным описанием: указывают место съёмок, модель камеры и т. д. Отличительная особенность сервиса — описание: его может предоставить не только тот, кто размещает фотографию, но и другие пользователи портала.

Данный проект - часть эксперимента по разработке поиска референсных фотографий для фотографов. Суть поиска заключается в следующем: пользователь сервиса вводит описание нужной сцены. Например, такое: A man is crossing a mountain pass on a metal bridge.

Сервис выводит несколько фотографий с такой же или похожей сценой.

Чтобы эксперимент получил право на жизнь, нужно защитить его перед руководителем компании. Для защиты необходимо презентовать так называемый PoC (Proof of Concept, Проверка концепции) — продемонстрировать, что такой проект практически осуществим. Результатом проекта должна стать демонстрационная версия поиска изображений по запросу.

Для демонстрационной версии нужно выбрать лучшую модель, которая получит векторное представление изображения, векторное представление текста, а на выходе выдаст число от 0 до 1 — и покажет, насколько текст и картинка подходят друг другу.

На основе лучшей модели можно будет собрать предварительную версию продукта, которую вы покажете руководителю компании.

##Юридические ограничения В некоторых странах, где работает компания With Sense, действуют ограничения по обработке изображений: поисковым сервисам и сервисам, предоставляющим возможность поиска, запрещено без разрешения родителей или законных представителей предоставлять любую информацию, в том числе, но не исключительно, текстов, изображений, видео и аудио, содержащие описание, изображение или запись голоса детей. Ребёнком считается любой человек, не достигший 16-ти лет.

При попытке посмотреть изображения, запрещённые законодательством, на сервисе вместо картинок показывается дисклеймер: This image is unavailable in your country in compliance with local laws.

Однако в PoC нет возможности воспользоваться данным функционалом. Поэтому необходимо очистить данные от проблемного контента. Во время тестирования модели при появлении в запросе “вредного” контента должен отображаться дисклеймер.

## Результат
Результат обучения выглядит довольно слабо. 

Модель научилась неплохо определять черное, мячи и собак. 

Кроме того, модель, кажется, получила некоторое представление о числах (например, на запрос 'two women ...' показывает собак, но двух) и цветах, но в основном применительно к собакам. 

Также она имеет некоторое представление о поверхностях: 'ice, water, rocks, mountains, dust, clouds, mud' ведут на картинки с поверхностями, не всегда правильными, но явно имеющими отношение к запросу.  

При этом модель посредственно отличает мужчин и женщин, и все, что связано с людьми.

Определенная корреляция между запросом и картинкой есть, но говорить о том, что картинка в основном соответствует запросу, нельзя. Есть частичное соответствие, и обычно модель показывает собак. 

Ожидаемо, в некоторых случаях модель выдает в качестве результата картинки с детьми, т.к. тестовый и обучающий датасеты от них не очищались, исключались только запросы с блок-словами и соответствующие им картинки. Это значит, что не все картинки с детьми были исключены из тренировочного датасета, и модель не имеет представления о детях.

Степень уверенности модели в предсказаниях низкая: степень соответствия картинки описанию редко оценивается числом выше 0.15. 

## Предложения по дальнейшему развитию проекта
Эксперимент кажется частичным успехом, но модель требует серьезного дообучения. 

Можно изменить предобработку текущего датасета: сгенерировать больше соответствующих друг другу пар, например, распарсив query_id; не убирать картинки, которым не соответствуют описания, попадающие под юридические ограничения. Можно найти более обширный датасет.

Можно учесть дисбаланс классов при обучении моделей, это может дать хороший результат.

Можно попробовать обучить модель в течение большего количества эпох, но сейчас она вылетает по колбэку early_stopping, так как метрика на валидации не улучшается.

В конце концов, можно постараться найти модель, обученную профессиональным коллективом на огромном датасете и выполняющую аналогичную задачу, а затем дообучить на датасете заказчика.