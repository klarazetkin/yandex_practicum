# Определение возраста покупателей
## Постановка задачи

Заказчик исследования - сетевой супермаркет «Хлеб-Соль». Заказчик внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
* Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
* Контролировать добросовестность кассиров при продаже алкоголя.
Задача - построить модель, которая по фотографии определит приблизительный возраст человека. В качестве датасета для обучения модели - набор фотографий людей с указанием возраста.

Проект выполнен в окружении Яндекс.Практикума.

## Анализ модели

Поставленную цель (МАЕ <= 8 на валидации) удалось достичь с помощью модели на основе ResNet50, к которой был добавлен один полносвязный слой с одним нейроном на выходе. Конфигурация сети:

```
    model = Sequential()
    model.add(backbone)
    model.add(GlobalAveragePooling2D())
    model.add(Flatten())
    model.add(Dense(1, activation='relu'))
```

Использовался оптимайзер Adam(lr=0.0001). Сеть очень быстро обучалась и переобучалась, поэтому число эпох было опытным путем сокращено до четырех. Для инициализации были использованы веса 'imagenet', полученные в результате обучения сети ResNet на датасете ImageNet. Сеть backbone (ResNet из 50 слоев) дообучалась на датасете. Достичь нужного MAE без дообучения backbone на датасете не удалось ни с одним, ни с двумя, ни с тремя добавленными слоями верхушки (top). 

Цель обучения достигнута, MAE на валидационном датасете составляет 6.4210, что означает, что на валидации модель определяет возраст человека по фото со средней погрешностью 6.4 года. 

Стоило бы запустить модель в другом окружении и проверить ее на тестовой выборке, чтоб оценить пригодность для дальнейших шагов по внедрению.